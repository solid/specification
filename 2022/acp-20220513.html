<!DOCTYPE html>
<html
  about="https://solidproject.org/TR/acp#"
  prefix="
    rdf: http://www.w3.org/1999/02/22-rdf-syntax-ns#
    rdfs: http://www.w3.org/2000/01/rdf-schema#
    owl: http://www.w3.org/2002/07/owl#
    xsd: http://www.w3.org/2001/XMLSchema#
    acp: http://www.w3.org/ns/solid/acp#
    dc: http://purl.org/dc/terms/
    doap: http://usefulinc.com/ns/doap#
    bibo: http://purl.org/ontology/bibo/
    cito: http://purl.org/spar/cito/
    schema: http://schema.org/
    vann: http://purl.org/vocab/vann/"
  dir="ltr"
  lang="en"
>
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <link rel="icon" href="./favicon.ico" />
    <title>Access Control Policy (ACP)</title>
    <link
      rel="stylesheet"
      href="https://www.w3.org/StyleSheets/TR/2016/base.css"
      media="all"
    />
    <link rel="stylesheet" href="./acp-main-20220513.css" media="all" />
    <link rel="stylesheet" href="./acp-code-20220513.css" media="all" />
  </head>
  <body vocab="https://solidproject.org/TR/acp#">
    <header class="head">
      <a class="logo" href="https:&#x2F;&#x2F;solidproject.org&#x2F;"
        ><img alt="Solid" src="../solid.svg" width="72" height="66"
      /></a>
      <h1 property="dc:title">Access Control Policy (ACP)</h1>
      <h2>
        <span property="rdfs:comment">Version 0.9.0</span>,
        <time property="dc:issued" datetime="2022-05-13">2022-05-13</time>
      </h2>
      <details open="">
        <summary>More details about this document</summary>
        <dl>
          <dt>This version</dt>
          <dd>
            <a href="https://solidproject.org/TR/2022/acp-20220513">https://solidproject.org/TR/2022/acp-20220513</a>
          </dd>
          <dt>Latest version</dt>
          <dd>
            <a href="https://solidproject.org/TR/acp">https://solidproject.org/TR/acp</a>
          </dd>
          <dt>Editor's draft</dt>
          <dd>
            <a href="https://solid.github.io/authorization-panel/acp-specification">https://solid.github.io/authorization-panel/acp-specification</a>
          </dd>
          <dt>Source repository</dt>
          <dd>
            <a href="https://github.com/solid/authorization-panel">https://github.com/solid/authorization-panel</a>
          </dd>
          <dt>Issue tracking</dt>
          <dd>
            <a href="https://github.com/solid/authorization-panel/issues">https://github.com/solid/authorization-panel/issues</a>
          </dd>
          <dt>License</dt>
          <dd>
            <a href="http://purl.org/NET/rdflicense/MIT1.0">MIT License</a>
          </dd>
          <dt>Editors</dt>
          <dd>
            <ul>
              <li rel="schema:creator schema:author">
                <span
                  about="https://id.inrupt.com/matthieu"
                  typeof="schema:Person"
                >
                  <a
                    rel="schema:url"
                    href="https://github.com/matthieubosquet/"
                  >
                    <span
                      about="https://id.inrupt.com/matthieu"
                      property="schema:name"
                    >
                      <span property="schema:givenName">Matthieu</span>
                      <span property="schema:familyName">Bosquet</span>
                    </span>
                  </a>
                </span>
              </li>
            </ul>
          </dd>
        </dl>
      </details>
      <p id="copyright" class="copyright">
        <span property="dc:license">MIT License.</span> Copyright Â©
        <span property="dc:dateCopyrighted">2022</span>
        <a
          rel="dc:rightsHolder"
          href="http:&#x2F;&#x2F;www.w3.org&#x2F;community&#x2F;solid&#x2F;"
          >W3C Solid Community Group</a
        >.
      </p>
    </header>

    <section
      datatype="rdf:HTML"
      typeof="bibo:Chapter"
      resource=":abstract"
      property="bibo:hasPart"
    >
      <h2 id="abstract">Abstract</h2>
      <p>
        This document defines the
        <span about="acp:" property="rdfs:label"
          >Access Control Policy Language (ACP)</span
        >.
        <span about="acp:" typeof="owl:Ontology" property="rdfs:comment"
          >ACP is a language for describing, controlling and granting access to
          resources.</span
        >
      </p>
    </section>

    <section
      datatype="rdf:HTML"
      typeof="bibo:Chapter"
      resource=":status-of-this-document"
      property="bibo:hasPart"
    >
      <h2 id="status-of-this-document">Status of this document</h2>
      <p>
        This section describes the status of this document at the time of its
        publication.
      </p>

      <p>
        This document was published by the
        <a href="https://www.w3.org/community/solid/">Solid Community Group</a>
        as an Editor&#39;s Draft. The sections that have been incorporated have
        been reviewed following the
        <a href="https://github.com/solid/process">Solid process</a>. However,
        the information in this document is still subject to change. You are
        invited to
        <a href="https://github.com/solid/specification/issues">contribute</a>
        any feedback, comments, or questions you might have.
      </p>

      <p>
        Publication as an Editor&#39;s Draft does not imply endorsement by the
        W3C Membership. This is a draft document and may be updated, replaced or
        obsoleted by other documents at any time. It is inappropriate to cite
        this document as other than work in progress.
      </p>

      <p>
        This document was produced by a group operating under the
        <a href="https://www.w3.org/community/about/agreements/cla/"
          >W3C Community Contributor License Agreement (CLA)</a
        >. A human-readable
        <a href="https://www.w3.org/community/about/agreements/cla-deed/"
          >summary</a
        >
        is available.
      </p>
    </section>
    <nav id="toc">
      <h2 id="table-of-contents">Table of Contents</h2>
      <ol class="toc">
        <li class="tocline">
          <a href="#abstract" class="tocxref">Abstract</a>
        </li>
        <li class="tocline">
          <a href="#status-of-this-document" class="tocxref"
            >Status of this document</a
          >
        </li>
        <li class="tocline">
          <a href="#introduction" class="tocxref"
            ><span class="secno">1</span>Introduction</a
          >
          <ol class="toc">
            <li class="tocline">
              <a href="#rdf-terminology" class="tocxref"
                ><span class="secno">1.1</span>RDF terminology</a
              >
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#namespaces" class="tocxref"
                ><span class="secno">1.2</span>RDF vocabularies and namespace
                IRIs</a
              >
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#acp-terminology" class="tocxref"
                ><span class="secno">1.3</span>ACP terminology</a
              >
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#example-graphs" class="tocxref"
                ><span class="secno">1.4</span>Example graphs</a
              >
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#data-model" class="tocxref"
                ><span class="secno">1.5</span>Data model</a
              >
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#ontology" class="tocxref"
                ><span class="secno">1.6</span>Ontology</a
              >
            </li>
          </ol>
        </li>
        <li class="tocline">
          <a href="#conformance" class="tocxref"
            ><span class="secno">2</span>Conformance</a
          >
        </li>
        <li class="tocline">
          <a href="#context-graph" class="tocxref"
            ><span class="secno">3</span>Context Graph</a
          >
          <ol class="toc">
            <li class="tocline">
              <a href="#context" class="tocxref"
                ><span class="secno">3.1</span>Context</a
              >
              <ol class="toc">
                <li class="tocline">
                  <a href="#example-context" class="tocxref"
                    ><span class="secno">3.1.1</span>Example Context</a
                  >
                </li>
              </ol>
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#context-extensibility" class="tocxref"
                ><span class="secno">3.2</span>Context extensibility</a
              >
              <ol class="toc">
                <li class="tocline">
                  <a href="#example-context-extension" class="tocxref"
                    ><span class="secno">3.2.1</span>Example Context
                    extension</a
                  >
                </li>
              </ol>
            </li>
          </ol>
        </li>
        <li class="tocline">
          <a href="#authorization-graph" class="tocxref"
            ><span class="secno">4</span>Authorization Graph</a
          >
          <ol class="toc">
            <li class="tocline">
              <a href="#access-control-resource" class="tocxref"
                ><span class="secno">4.1</span>Access Control Resource</a
              >
              <ol class="toc">
                <li class="tocline">
                  <a href="#example-access-control-resource" class="tocxref"
                    ><span class="secno">4.1.1</span>Example Access Control
                    Resource</a
                  >
                </li>
              </ol>
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#access-control" class="tocxref"
                ><span class="secno">4.2</span>Access Control</a
              >
              <ol class="toc">
                <li class="tocline">
                  <a href="#example-access-control" class="tocxref"
                    ><span class="secno">4.2.1</span>Example Access Control</a
                  >
                </li>
              </ol>
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#policy" class="tocxref"
                ><span class="secno">4.3</span>Policy</a
              >
              <ol class="toc">
                <li class="tocline">
                  <a href="#example-policy" class="tocxref"
                    ><span class="secno">4.3.1</span>Example Policy</a
                  >
                </li>
              </ol>
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#matcher" class="tocxref"
                ><span class="secno">4.4</span>Matcher</a
              >
              <ol class="toc">
                <li class="tocline">
                  <a href="#example-matcher" class="tocxref"
                    ><span class="secno">4.4.1</span>Example Matcher</a
                  >
                </li>
              </ol>
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#matcher-extensibility" class="tocxref"
                ><span class="secno">4.5</span>Matcher extensibility</a
              >
              <ol class="toc">
                <li class="tocline">
                  <a href="#example-matcher-extension" class="tocxref"
                    ><span class="secno">4.5.1</span>Example Matcher
                    extension</a
                  >
                </li>
              </ol>
            </li>
          </ol>
        </li>
        <li class="tocline">
          <a href="#access-grant-graph" class="tocxref"
            ><span class="secno">5</span>Access Grant Graph</a
          >
          <ol class="toc">
            <li class="tocline">
              <a href="#access-grant" class="tocxref"
                ><span class="secno">5.1</span>Access Grant</a
              >
              <ol class="toc">
                <li class="tocline">
                  <a href="#example-access-grant" class="tocxref"
                    ><span class="secno">5.1.1</span>Example Access Grant</a
                  >
                </li>
              </ol>
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#access-mode-extensibility" class="tocxref"
                ><span class="secno">5.2</span>Access Mode extensibility</a
              >
              <ol class="toc">
                <li class="tocline">
                  <a href="#example-access-mode" class="tocxref"
                    ><span class="secno">5.2.1</span>Example Access Mode</a
                  >
                </li>
              </ol>
            </li>
          </ol>
        </li>
        <li class="tocline">
          <a href="#access-control-resolution" class="tocxref"
            ><span class="secno">6</span>Access Control resolution</a
          >
          <ol class="toc">
            <li class="tocline">
              <a href="#effective-policies" class="tocxref"
                ><span class="secno">6.1</span>Effective Policies</a
              >
              <ol class="toc">
                <li class="tocline">
                  <a href="#effective-policies-example" class="tocxref"
                    ><span class="secno">6.1.1</span>Effective Policies
                    example</a
                  >
                </li>
              </ol>
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#granted-access-modes" class="tocxref"
                ><span class="secno">6.2</span>Granted Access Modes</a
              >
              <ol class="toc">
                <li class="tocline">
                  <a href="#granted-access-modes-example" class="tocxref"
                    ><span class="secno">6.2.1</span>Granted Access Modes
                    example</a
                  >
                </li>
              </ol>
              <ol class="toc">
                <li class="tocline">
                  <a href="#granted-access-modes-pseudocode" class="tocxref"
                    ><span class="secno">6.2.2</span>Granted Access Modes
                    pseudocode</a
                  >
                </li>
              </ol>
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#satisfied-policy" class="tocxref"
                ><span class="secno">6.3</span>Satisfied Policy</a
              >
              <ol class="toc">
                <li class="tocline">
                  <a href="#satisfied-policy-example" class="tocxref"
                    ><span class="secno">6.3.1</span>Satisfied Policy example</a
                  >
                </li>
              </ol>
              <ol class="toc">
                <li class="tocline">
                  <a href="#satisfied-policy-pseudocode" class="tocxref"
                    ><span class="secno">6.3.2</span>Satisfied Policy
                    pseudocode</a
                  >
                </li>
              </ol>
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#satisfied-matcher" class="tocxref"
                ><span class="secno">6.4</span>Satisfied Matcher</a
              >
              <ol class="toc">
                <li class="tocline">
                  <a href="#satisfied-matcher-example" class="tocxref"
                    ><span class="secno">6.4.1</span>Satisfied Matcher
                    example</a
                  >
                </li>
              </ol>
              <ol class="toc">
                <li class="tocline">
                  <a href="#satisfied-matcher-pseudocode" class="tocxref"
                    ><span class="secno">6.4.2</span>Satisfied Matcher
                    pseudocode</a
                  >
                </li>
              </ol>
            </li>
          </ol>
        </li>
        <li class="tocline">
          <a href="#server-implementation" class="tocxref"
            ><span class="secno">7</span>Server implementation</a
          >
          <ol class="toc">
            <li class="tocline">
              <a href="#capability-discovery" class="tocxref"
                ><span class="secno">7.1</span>Capability discovery</a
              >
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#acr-discovery" class="tocxref"
                ><span class="secno">7.2</span>ACR discovery</a
              >
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#acr-editing" class="tocxref"
                ><span class="secno">7.3</span>ACR editing</a
              >
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#resource-management" class="tocxref"
                ><span class="secno">7.4</span>Resource management</a
              >
            </li>
          </ol>
        </li>
        <li class="tocline">
          <a href="#acknowledgements" class="tocxref">Acknowledgements</a>
        </li>
        <li class="tocline">
          <a href="#references" class="tocxref">References</a>
          <ol class="toc">
            <li class="tocline">
              <a href="#normative-references" class="tocxref"
                >Normative references</a
              >
            </li>
          </ol>
          <ol class="toc">
            <li class="tocline">
              <a href="#informative-references" class="tocxref"
                >Informative references</a
              >
            </li>
          </ol>
        </li>
      </ol>
    </nav>
    <main>
      <section
        datatype="rdf:HTML"
        typeof="bibo:Chapter"
        resource=":introduction"
        property="bibo:hasPart"
      >
        <h2 class="heading" id="introduction">
          <span class="secno">1. </span><span class="content">Introduction</span
          ><a class="self-link" href="#introduction"></a>
        </h2>
        <p>
          This section introduces ACP with an overview of key terminology, an
          explanation of the conventions used in this document, example graphs
          to illustrate basic concepts of resource access description and
          validation, a diagram representing the main elements of the ACP data
          model, and a non-normative RDF representation of the ACP ontology.
        </p>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":rdf-terminology"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="rdf-terminology">
            <span class="secno">1.1. </span
            ><span class="content">RDF terminology</span
            ><a class="self-link" href="#rdf-terminology"></a>
          </h3>
          <p>
            This document uses the terms
            <a href="http://www.w3.org/TR/rdf11-concepts/#dfn-resource"
              ><dfn id="rdf-resource">resource</dfn></a
            >,
            <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-property"
              ><dfn id="rdf-property">property</dfn></a
            >,
            <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-vocabulary"
              ><dfn id="rdf-vocabulary">RDF vocabulary</dfn></a
            >,
            <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-namespace"
              ><dfn id="rdf-namespace">namespace</dfn></a
            >,
            <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-namespace-iri"
              ><dfn id="rdf-namespace-iri">namespace IRI</dfn></a
            >,
            <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-namespace-prefix"
              ><dfn id="rdf-namespace-prefix">namespace prefix</dfn></a
            >,
            <a href="http://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph"
              ><dfn id="rdf-graph">RDF graph</dfn></a
            >,
            <a href="http://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple"
              ><dfn id="rdf-triple">RDF triple</dfn></a
            >,
            <a href="http://www.w3.org/TR/rdf11-concepts/#dfn-iri"
              ><dfn id="rdf-iri">IRI</dfn></a
            >,
            <a href="http://www.w3.org/TR/rdf11-concepts/#dfn-literal"
              ><dfn id="rdf-literal">literal</dfn></a
            >,
            <a href="http://www.w3.org/TR/rdf11-concepts/#dfn-blank-node"
              ><dfn id="rdf-blank-node">blank node</dfn></a
            >,
            <a href="http://www.w3.org/TR/rdf11-concepts/#dfn-node"
              ><dfn id="rdf-node">node</dfn></a
            >
            of an RDF graph,
            <a href="http://www.w3.org/TR/rdf11-concepts/#dfn-rdf-term"
              ><dfn id="rdf-term">RDF term</dfn></a
            >,
            <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-subject"
              ><dfn id="rdf-subject">subject</dfn></a
            >,
            <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate"
              ><dfn id="rdf-predicate">predicate</dfn></a
            >, and
            <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-object"
              ><dfn id="rdf-object">object</dfn></a
            >
            of RDF triples,
            <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-datatype"
              ><dfn id="rdf-datatype">datatype</dfn></a
            >, and
            <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri-equality"
              ><dfn id="rdf-iri-eqality">IRI</dfn></a
            >
            and
            <a
              href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal-term-equality"
              ><dfn id="rdf-literal-term-eqality">literal term equality</dfn></a
            >
            as defined in RDF 1.1 Concepts and Abstract Syntax
            <cite
              ><a class="bibref" href="#rdf11-concepts">RDF11 CONCEPTS</a></cite
            >.
          </p>
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":namespaces"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="namespaces">
            <span class="secno">1.2. </span
            ><span class="content">RDF vocabularies and namespace IRIs</span
            ><a class="self-link" href="#namespaces"></a>
          </h3>
          <p>
            This document uses the following RDF vocabularies and corresponding
            namespace prefix bindings:
          </p>

          <table>
            <thead>
              <tr>
                <th>Prefix</th>
                <th>Namespace</th>
              </tr>
            </thead>
            <tbody>
              <tr about="acp:">
                <td>
                  <code property="vann:preferredNamespacePrefix">acp:</code>
                </td>
                <td>
                  <code
                    ><a
                      href="http://www.w3.org/ns/solid/acp#"
                      property="vann:preferredNamespaceUri"
                      >http://www.w3.org/ns/solid/acp#</a
                    ></code
                  >
                </td>
              </tr>
              <tr>
                <td><code>acl:</code></td>
                <td>
                  <code
                    ><a href="http://www.w3.org/ns/auth/acl#"
                      >http://www.w3.org/ns/auth/acl#</a
                    ></code
                  >
                </td>
              </tr>
              <tr>
                <td><code>ex:</code></td>
                <td>
                  <code
                    ><a href="https://example.org/"
                      >https://example.org/</a
                    ></code
                  >
                </td>
              </tr>
              <tr>
                <td><code>ldp:</code></td>
                <td>
                  <code
                    ><a href="http://www.w3.org/ns/ldp#"
                      >http://www.w3.org/ns/ldp#</a
                    ></code
                  >
                </td>
              </tr>
              <tr>
                <td><code>rdf:</code></td>
                <td>
                  <code
                    ><a href="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                      >http://www.w3.org/1999/02/22-rdf-syntax-ns#</a
                    ></code
                  >
                </td>
              </tr>
              <tr>
                <td><code>rdfs:</code></td>
                <td>
                  <code
                    ><a href="http://www.w3.org/2000/01/rdf-schema#"
                      >http://www.w3.org/2000/01/rdf-schema#</a
                    ></code
                  >
                </td>
              </tr>
              <tr>
                <td><code>owl:</code></td>
                <td>
                  <code
                    ><a href="http://www.w3.org/2002/07/owl#"
                      >http://www.w3.org/2002/07/owl#</a
                    ></code
                  >
                </td>
              </tr>
            </tbody>
          </table>
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":acp-terminology"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="acp-terminology">
            <span class="secno">1.3. </span
            ><span class="content">ACP terminology</span
            ><a class="self-link" href="#acp-terminology"></a>
          </h3>
          <p><em>This section is non-normative.</em></p>

          <dl>
            <dt id="terminology-context-graph">Context graph</dt>
            <dd>
              <a href="#context-graph">Context graphs</a> describe the
              attributes of resource access instances. Those attributes can be
              matched to sets of conditions defined in the form of an
              <a href="#terminology-authorization-graph">authorization graph</a>
              in order to determine Access Modes granted over resources.
            </dd>
            <dt id="terminology-authorization-graph">Authorization graph</dt>
            <dd>
              <a href="#authorization-graph">Authorization graphs</a>
              authoritatively define the conditions for granting Access Modes
              over resources through Access Controls, Policies and Matchers. The
              result of applying an authorization graph to a described instance
              of resource access is an
              <a href="#terminology-access-grant-graph">access grant graph</a>.
            </dd>
            <dt id="terminology-access-grant-graph">Access grant graph</dt>
            <dd>
              <a href="#access-grant-graph">Access grant graphs</a> describe
              sets of granted access modes over resources in the context of
              resource access instances.
            </dd>
          </dl>
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":example-graphs"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="example-graphs">
            <span class="secno">1.4. </span
            ><span class="content">Example graphs</span
            ><a class="self-link" href="#example-graphs"></a>
          </h3>
          <p><em>This section is non-normative.</em></p>

          <p>
            Throughout this document, color-coded boxes contain the RDF
            representation of example context graphs, authorization graphs, and
            access grant graphs serialized in Turtle. Those graphs use a mix of
            IRIs and blank nodes where applicable to better show the range of
            possible representations.
          </p>

          <p>
            The following example
            <a href="#terminology-context-graph">context graph</a> describes an
            instance of resource access and could be translated as:
            <em
              >"Bob is trying to access resource X using client application Y
              with his identity asserted by identity provider Z."</em
            >.
          </p>

          <pre id="example-context-graph" class="example example-context-graph">
# This box contains a context graph
# It describes an instance of resource access&nbsp;&nbsp;

[]
  acp:agent ex:Bob ;
  acp:target ex:resourceX ;
  acp:client ex:ClientApplicationY ;
  acp:issuer ex:IdentityProviderZ .
</pre
          >

          <p>
            The following example
            <a href="#terminology-authorization-graph">authorization graph</a>
            authoritatively defines the conditions of access to resource X and
            could be translated as:
            <em
              >"Access to resource X is mandated by one Access Control that
              applies one Policy which allows access mode
              <code>acl:Read</code> when the agent matcher is satisfied that
              Alice or Bob are the agent trying to access resource X."</em
            >.
          </p>

          <pre
            id="example-authorization-graph"
            class="example example-authorization-graph"
          >
# This box contains an authorization graph
# It describes the conditions required for accessing a resource&nbsp;&nbsp;

[]
  a acp:AccessControlResource ;
  acp:resource ex:resourceX ;
  acp:accessControl [
    a acp:AccessControl ;
    acp:apply [
      a acp:Policy ;
      acp:allow acl:Read ;
      acp:anyOf [
        a acp:AgentMatcher ;
        acp:agent ex:Alice, ex:Bob ;
      ]
    ]
  ] .
</pre
          >

          <p>
            The following example
            <a href="#terminology-access-grant-graph">access grant graph</a> is
            the result of applying the previous example authorization graph
            which defines access to resource X to the previous example context
            graph which describes an instance of access to target resource X.
            Bob is matched as the context agent and since it defines no further
            restrictions, the policy allowing <code>acl:Read</code> is
            satisfied. The following access grant graph could be read as:
            <em
              >"The access mode <code>acl:Read</code> is granted to Bob whom
              requested access to resource X using client application Y and
              whose identity was asserted by identity provider Z."</em
            >.
          </p>

          <pre
            id="example-access-grant-graph"
            class="example example-access-grant-graph"
          >
# This box contains an access grant graph
# It describes in context the granted access over a resource&nbsp;&nbsp;

[]
  acp:grant acl:Read ;
  acp:context [
    acp:agent ex:Bob ;
    acp:target ex:resourceX ;
    acp:client ex:ClientApplicationY ;
    acp:issuer ex:IdentityProviderZ ;
  ] .
</pre
          >
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":data-model"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="data-model">
            <span class="secno">1.5. </span
            ><span class="content">Data model</span
            ><a class="self-link" href="#data-model"></a>
          </h3>
          <p><em>This section is non-normative.</em></p>
          <p>The following diagram illustrates the main elements of ACP.</p>
          <img
            alt="ACP Data Model"
            src="acp-data-model-20220513.svg"
            style="width: 100%"
          />
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":ontology"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="ontology">
            <span class="secno">1.6. </span><span class="content">Ontology</span
            ><a class="self-link" href="#ontology"></a>
          </h3>
          <p>
            All terms defined by the Access Control Policy Language are present
            in a non-normative RDF representation of the
            <a href="./acp.ttl">ACP ontology serialized in turtle</a>.
          </p>
        </section>
      </section>

      <section
        datatype="rdf:HTML"
        typeof="bibo:Chapter"
        resource=":conformance"
        property="bibo:hasPart"
      >
        <h2 class="heading" id="conformance">
          <span class="secno">2. </span><span class="content">Conformance</span
          ><a class="self-link" href="#conformance"></a>
        </h2>
        <p>
          All assertions, diagrams, examples, pseudocode and notes are
          non-normative, as are all sections explicitly marked non-normative.
          Everything else is normative.
        </p>

        <p id="rfc2119-conformance">
          The key words
          <a href="https://datatracker.ietf.org/doc/html/rfc2119#section-1"
            ><dfn id="rfc2119-must">MUST</dfn></a
          >,
          <a href="https://datatracker.ietf.org/doc/html/rfc2119#section-2"
            ><dfn id="rfc2119-must-not">MUST NOT</dfn></a
          >,
          <a href="https://datatracker.ietf.org/doc/html/rfc2119#section-1"
            ><dfn id="rfc2119-required">REQUIRED</dfn></a
          >,
          <a href="https://datatracker.ietf.org/doc/html/rfc2119#section-1"
            ><dfn id="rfc2119-shall">SHALL</dfn></a
          >,
          <a href="https://datatracker.ietf.org/doc/html/rfc2119#section-2"
            ><dfn id="rfc2119-shall-not">SHALL NOT</dfn></a
          >,
          <a href="https://datatracker.ietf.org/doc/html/rfc2119#section-3"
            ><dfn id="rfc2119-should">SHOULD</dfn></a
          >,
          <a href="https://datatracker.ietf.org/doc/html/rfc2119#section-4"
            ><dfn id="rfc2119-should-not">SHOULD NOT</dfn></a
          >,
          <a href="https://datatracker.ietf.org/doc/html/rfc2119#section-3"
            ><dfn id="rfc2119-recommended">RECOMMENDED</dfn></a
          >,
          <a href="https://datatracker.ietf.org/doc/html/rfc2119#section-5"
            ><dfn id="rfc2119-may">MAY</dfn></a
          >, and
          <a href="https://datatracker.ietf.org/doc/html/rfc2119#section-5"
            ><dfn id="rfc2119-optional">OPTIONAL</dfn></a
          >, are to be interpreted as defined in
          <cite><a class="bibref" href="#rfc2119">RFC 2119</a></cite
          >.
        </p>

        <p>
          Only UPPERCASE usage of the key words defined in RFC 2119 have special
          meanings, as per
          <cite><a class="bibref" href="#rfc8174">RFC 8174</a></cite
          >.
        </p>
      </section>

      <section
        datatype="rdf:HTML"
        typeof="bibo:Chapter"
        resource=":context-graph"
        property="bibo:hasPart"
      >
        <h2 class="heading" id="context-graph">
          <span class="secno">3. </span
          ><span class="content">Context Graph</span
          ><a class="self-link" href="#context-graph"></a>
        </h2>
        <p>
          This section introduces the ACP terms used to describe instances of
          resource access.
        </p>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":context"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="context">
            <span class="secno">3.1. </span><span class="content">Context</span
            ><a class="self-link" href="#context"></a>
          </h3>
          <dl>
            <dt
              id="acp-Context"
              about="acp:Context"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdfs:Class"
            >
              <code>acp:Context</code>
            </dt>
            <dd about="acp:Context" property="rdfs:comment">
              Instances of the <span property="rdfs:label">Context</span> class
              describe instances of resource access.
            </dd>

            <dt
              id="acp-attribute"
              about="acp:attribute"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:attribute</code>
            </dt>
            <dd about="acp:attribute" property="rdfs:comment">
              The <span property="rdfs:label">attribute</span> properties
              defined by ACP describe
              <span property="rdfs:domain" resource="acp:Context"
                >instances</span
              >
              of
              <span property="rdfs:range" resource="rdfs:Resource"
                >resource</span
              >
              access.
            </dd>

            <dt
              id="acp-target"
              about="acp:target"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:target</code>
            </dt>
            <dd about="acp:target" typeof="rdfs:comment">
              The <span property="rdfs:label">target</span>
              <span property="rdfs:subPropertyOf" resource="acp:attribute"
                >attribute</span
              >
              describes requested resources.
            </dd>

            <dt
              id="acp-mode"
              about="acp:mode"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:mode</code>
            </dt>
            <dd about="acp:mode" typeof="rdfs:comment">
              The <span property="rdfs:label">mode</span>
              <span property="rdfs:subPropertyOf" resource="acp:attribute"
                >attribute</span
              >
              describes requested modes of access.
            </dd>

            <dt
              id="acp-agent"
              about="acp:agent"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:agent</code>
            </dt>
            <dd about="acp:agent" typeof="rdfs:comment">
              The <span property="rdfs:label">agent</span>
              <span property="rdfs:subPropertyOf" resource="acp:attribute"
                >attribute</span
              >
              describes agents initiating requests.
            </dd>

            <dt
              id="acp-creator"
              about="acp:creator"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:creator</code>
            </dt>
            <dd about="acp:creator" typeof="rdfs:comment">
              The <span property="rdfs:label">creator</span>
              <span property="rdfs:subPropertyOf" resource="acp:attribute"
                >attribute</span
              >
              describes creators of requested resources.
            </dd>

            <dt
              id="acp-owner"
              about="acp:owner"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:owner</code>
            </dt>
            <dd about="acp:owner" typeof="rdfs:comment">
              The <span property="rdfs:label">owner</span>
              <span property="rdfs:subPropertyOf" resource="acp:attribute"
                >attribute</span
              >
              describes owners of requested resources.
            </dd>

            <dt
              id="acp-client"
              about="acp:client"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:client</code>
            </dt>
            <dd about="acp:client" typeof="rdfs:comment">
              The <span property="rdfs:label">client</span>
              <span property="rdfs:subPropertyOf" resource="acp:attribute"
                >attribute</span
              >
              describes client applications used to request resources.
            </dd>

            <dt
              id="acp-issuer"
              about="acp:issuer"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:issuer</code>
            </dt>
            <dd about="acp:issuer" typeof="rdfs:comment">
              The <span property="rdfs:label">issuer</span>
              <span property="rdfs:subPropertyOf" resource="acp:attribute"
                >attribute</span
              >
              describes identity providers used to assert the identity of agents
              requesting resources.
            </dd>

            <dt
              id="acp-time"
              about="acp:time"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:time</code>
            </dt>
            <dd about="acp:time" typeof="rdfs:comment">
              The <span property="rdfs:label">time</span>
              <span property="rdfs:subPropertyOf" resource="acp:attribute"
                >attribute</span
              >
              describes times of resource access requests.
            </dd>

            <dt
              id="acp-vc"
              about="acp:vc"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:vc</code>
            </dt>
            <dd about="acp:vc" typeof="rdfs:comment">
              The <span property="rdfs:label">vc</span>
              <span property="rdfs:subPropertyOf" resource="acp:attribute"
                >attribute</span
              >
              describes verifiable credentials presented as part of resource
              access requests.
            </dd>
          </dl>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":example-context"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="example-context">
              <span class="secno">3.1.1. </span
              ><span class="content">Example Context</span
              ><a class="self-link" href="#example-context"></a>
            </h4>

            <p>
              The following example context graph denotes instances of resource
              access over resource X initiated by Bob.
            </p>

            <pre id="example-context-0" class="example example-context-graph">
[]
  a acp:Context ;
  acp:agent ex:Bob .&nbsp;&nbsp;
</pre
            >

            <p>
              The following example context graph denotes instances of resource
              access over resource X initiated by Bob using client application Y
              where Bob's identity is asserted by identity provider Z, Bob is
              the owner of resource X, and Alice is the creator of resource X.
            </p>

            <pre id="example-context-1" class="example example-context-graph">
ex:contextA
  acp:agent ex:Bob ;
  acp:target ex:resourceX ;
  acp:owner ex:Bob ;
  acp:creator ex:Alice ;
  acp:client ex:ClientApplicationY ;&nbsp;&nbsp;
  acp:issuer ex:IdentityProviderZ .
</pre
            >

            <p>
              The following example context graph denotes instances of resource
              access where client application X or client application Y are used
              and identity is asserted by identity provider Z.
            </p>

            <pre id="example-context-2" class="example example-context-graph">
[
  acp:client ex:ClientApplicationX, ex:ClientApplicationY ;&nbsp;&nbsp;
  acp:issuer ex:IdentityProviderZ ;
] .
</pre
            >
          </section>
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":context-extensibility"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="context-extensibility">
            <span class="secno">3.2. </span
            ><span class="content">Context extensibility</span
            ><a class="self-link" href="#context-extensibility"></a>
          </h3>
          <p about="acp:attribute" property="rdfs:comment">
            Sub-properties of <code>acp:attribute</code> can be created to fit
            the specific resource access description requirements of
            applications.
          </p>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":example-context-extension"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="example-context-extension">
              <span class="secno">3.2.1. </span
              ><span class="content">Example Context extension</span
              ><a class="self-link" href="#example-context-extension"></a>
            </h4>
            <p>
              Let's imagine a property <code>ex:tag</code> defined as a an
              <code>rdfs:subPropertyOf acp:attribute</code> that would describe
              tags applied to requested resources. If such a property was
              defined, then the following example context graph would denote
              instances of resource access over resource X initiated by Bob
              where resource X was tagged <code>ex:Music</code> and
              <code>ex:FavouriteRecord</code>.
            </p>

            <pre
              id="example-context-extensibility-0"
              class="example example-context-graph"
            >
ex:contextA
  acp:agent ex:Bob ;
  acp:target ex:resourceX ;
  ex:tag ex:Music, ex:FavouriteRecord .&nbsp;&nbsp;
</pre
            >
          </section>
        </section>
      </section>

      <section
        datatype="rdf:HTML"
        typeof="bibo:Chapter"
        resource=":authorization-graph"
        property="bibo:hasPart"
      >
        <h2 class="heading" id="authorization-graph">
          <span class="secno">4. </span
          ><span class="content">Authorization Graph</span
          ><a class="self-link" href="#authorization-graph"></a>
        </h2>
        <p>
          This section introduces the ACP terms used to control access to
          resources.
        </p>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":access-control-resource"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="access-control-resource">
            <span class="secno">4.1. </span
            ><span class="content">Access Control Resource</span
            ><a class="self-link" href="#access-control-resource"></a>
          </h3>
          <dl>
            <dt
              id="acp-access-control-resource"
              about="acp:AccessControlResource"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdfs:Class"
            >
              <code>acp:AccessControlResource</code>
            </dt>
            <dd about="acp:AccessControlResource" property="rdfs:comment">
              Instances of the
              <span property="rdfs:label">Access Control Resource</span> (ACR)
              class connect resources to their Access Controls.
            </dd>

            <dt
              id="acp-resource"
              about="acp:resource"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:resource</code>
            </dt>
            <dd about="acp:resource" property="rdfs:comment">
              The <span property="rdfs:label">resource</span> property connects
              <span property="rdfs:domain" resource="acp:AccessControlResource"
                >ACRs</span
              >
              to
              <span property="rdfs:range" resource="rdfs:Resource"
                >resources</span
              >
              they control. It is the inverse of
              <code
                property="owl:inverseOf"
                resource="acp:accessControlResource"
                >acp:accessControlResource</code
              >.
            </dd>

            <dt
              id="acp-access-control"
              about="acp:accessControl"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:accessControl</code>
            </dt>
            <dd about="acp:accessControl" property="rdfs:comment">
              The <span property="rdfs:label">access control</span> property
              connects
              <span property="rdfs:domain" resource="acp:AccessControlResource"
                >ACRs</span
              >
              to
              <span property="rdfs:range" resource="acp:AccessControl"
                >Access Controls</span
              >.
            </dd>

            <dt
              id="acp-member-access-control"
              about="acp:memberAccessControl"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:memberAccessControl</code>
            </dt>
            <dd about="acp:memberAccessControl" property="rdfs:comment">
              The
              <span property="rdfs:label">member access control</span> property
              transitively connects
              <span property="rdfs:domain" resource="acp:AccessControlResource"
                >ACRs</span
              >
              of member resources to
              <span property="rdfs:range" resource="acp:AccessControl"
                >Access Controls</span
              >.
            </dd>
          </dl>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":example-access-control-resource"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="example-access-control-resource">
              <span class="secno">4.1.1. </span
              ><span class="content">Example Access Control Resource</span
              ><a class="self-link" href="#example-access-control-resource"></a>
            </h4>
            <p>
              The following example authorization graph means that access to
              resource X is controlled by both Access Controls B and C;
              furthermore, access to members of resource X is controlled by
              Access Control D.
            </p>

            <pre
              id="example-access-control-resource-0"
              class="example example-authorization-graph"
            >
ex:accessControlResourceA
  acp:resource ex:resourceX ;
  acp:accessControl ex:accessControlB, ex:accessControlC ;&nbsp;&nbsp;
  acp:memberAccessControl ex:accessControlD .
</pre
            >
          </section>
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":access-control"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="access-control">
            <span class="secno">4.2. </span
            ><span class="content">Access Control</span
            ><a class="self-link" href="#access-control"></a>
          </h3>
          <dl>
            <dt
              id="acp-access-control-class"
              about="acp:AccessControl"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdfs:Class"
            >
              <code>acp:AccessControl</code>
            </dt>
            <dd about="acp:AccessControl" property="rdfs:comment">
              Instances of the
              <span property="rdfs:label">Access Control</span> class connect
              Access Control Resources to their Policies.
            </dd>

            <dt
              id="acp-apply"
              about="acp:apply"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:apply</code>
            </dt>
            <dd about="acp:apply" property="rdfs:comment">
              The <span property="rdfs:label">apply</span> property connects
              <span property="rdfs:domain" resource="acp:AccessControl"
                >Access Controls</span
              >
              to the
              <span property="rdfs:range" resource="acp:Policy">Policies</span>
              they apply to resources.
            </dd>
          </dl>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":example-access-control"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="example-access-control">
              <span class="secno">4.2.1. </span
              ><span class="content">Example Access Control</span
              ><a class="self-link" href="#example-access-control"></a>
            </h4>
            <p>
              The following example authorization graph means that access to
              resource X is controlled by Policy C.
            </p>

            <pre
              id="example-access-control-0"
              class="example example-authorization-graph"
            >
ex:accessControlResourceA
  acp:resource ex:resourceX ;&nbsp;&nbsp;
  acp:accessControl [
    acp:apply ex:policyC ;
  ] .
</pre
            >

            <p>
              The following two example authorization graphs mean that access to
              resource X is controlled by Policy D and Policy E.
            </p>

            <pre
              id="example-access-control-1"
              class="example example-authorization-graph"
            >
ex:accessControlResourceA
  acp:resource ex:resourceX ;
  acp:accessControl ex:accessControlB, ex:accessControlC .&nbsp;&nbsp;

ex:accessControlB
  acp:apply ex:policyD .

ex:accessControlC
  acp:apply ex:policyE .
</pre
            >

            <pre
              id="example-access-control-2"
              class="example example-authorization-graph"
            >
[]
  acp:resource ex:resourceX ;
  acp:accessControl ex:accessControlF .&nbsp;&nbsp;

ex:accessControlF
  acp:apply ex:policyD, ex:policyE .
</pre
            >
          </section>
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":policy"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="policy">
            <span class="secno">4.3. </span><span class="content">Policy</span
            ><a class="self-link" href="#policy"></a>
          </h3>
          <dl>
            <dt
              id="acp-policy"
              about="acp:Policy"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdfs:Class"
            >
              <code>acp:Policy</code>
            </dt>
            <dd about="acp:Policy" property="rdfs:comment">
              Instances of the <span property="rdfs:label">Policy</span> class
              connect Access Controls to allowed and denied Access Modes as well
              as sets of Matchers describing instances of resource access.
            </dd>

            <dt
              id="acp-allow"
              about="acp:allow"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:allow</code>
            </dt>
            <dd about="acp:allow" property="rdfs:comment">
              The <span property="rdfs:label">allow</span> property connects
              <span property="rdfs:domain" resource="acp:Policy">Policies</span>
              to the
              <span property="rdfs:range" resource="acp:AccessMode"
                >Access Modes</span
              >
              they allow if satisfied.
            </dd>

            <dt
              id="acp-deny"
              about="acp:deny"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:deny</code>
            </dt>
            <dd about="acp:deny" property="rdfs:comment">
              The <span property="rdfs:label">deny</span> property connects
              <span property="rdfs:domain" resource="acp:Policy">Policies</span>
              to the
              <span property="rdfs:range" resource="acp:AccessMode"
                >Access Modes</span
              >
              they deny if satisfied.
            </dd>

            <dt
              id="acp-allOf"
              about="acp:allOf"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:allOf</code>
            </dt>
            <dd about="acp:allOf" property="rdfs:comment">
              The <span property="rdfs:label">all of</span> property connects
              <span property="rdfs:domain" resource="acp:Policy">Policies</span>
              to the set of
              <span property="rdfs:range" resource="acp:Matcher">Matchers</span>
              all of which MUST must be satisfied for the Policy to be
              satisfied.
            </dd>

            <dt
              id="acp-anyOf"
              about="acp:anyOf"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:anyOf</code>
            </dt>
            <dd about="acp:anyOf" property="rdfs:comment">
              The <span property="rdfs:label">any of</span> property connects
              <span property="rdfs:domain" resource="acp:Policy">Policies</span>
              to the set of
              <span property="rdfs:range" resource="acp:Matcher">Matchers</span>
              at least one of which MUST be satisfied for the Policy to be
              satisfied.
            </dd>

            <dt
              id="acp-noneOf"
              about="acp:noneOf"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:noneOf</code>
            </dt>
            <dd about="acp:noneOf" property="rdfs:comment">
              The <span property="rdfs:label">none of</span> property connects
              <span property="rdfs:domain" resource="acp:Policy">Policies</span>
              to the set of
              <span property="rdfs:range" resource="acp:Matcher">Matchers</span>
              all of which MUST NOT be satisfied for the Policy to be satisfied.
            </dd>
          </dl>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":example-policy"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="example-policy">
              <span class="secno">4.3.1. </span
              ><span class="content">Example Policy</span
              ><a class="self-link" href="#example-policy"></a>
            </h4>
            <p>
              The following example authorization graph means that Policy A will
              allow Read for instances of resource access satisfying both
              Matcher B and Matcher C.
            </p>

            <pre
              id="example-policy-0"
              class="example example-authorization-graph"
            >
ex:policyA
  acp:allow acl:Read ;
  acp:allOf ex:matcherB, ex:matcherC .&nbsp;&nbsp;
</pre
            >

            <p>
              The following example authorization graph means that a Policy will
              deny Write for instances of resource access satisfying either
              Matcher B or Matcher C.
            </p>

            <pre
              id="example-policy-1"
              class="example example-authorization-graph"
            >
[]
  acp:deny acl:Write ;
  acp:anyOf ex:matcherB, ex:matcherC .&nbsp;&nbsp;
</pre
            >

            <p>
              The following example authorization graph means that Reading and
              Writing resource X will be allowed for instances of resource
              access satisfying Matcher A and not Matcher B.
            </p>

            <pre
              id="example-policy-2"
              class="example example-authorization-graph"
            >
[
  acp:resource ex:resourceX ;
  acp:accessControl [
    acp:apply [
      acp:allow acl:Read, acl:Write ;&nbsp;&nbsp;
      acp:anyOf ex:matcherA ;
      acp:noneOf ex:matcherB ;
    ] ;
  ] ;
] .
</pre
            >
          </section>
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":matcher"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="matcher">
            <span class="secno">4.4. </span><span class="content">Matcher</span
            ><a class="self-link" href="#matcher"></a>
          </h3>
          <dl>
            <dt
              id="acp-matcher"
              about="acp:Matcher"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdfs:Class"
            >
              <code>acp:Matcher</code>
            </dt>
            <dd about="acp:Matcher" property="rdfs:comment">
              Instances of the <span property="rdfs:label">Matcher</span> class
              are descriptions of matching resource access Contexts. To satisfy
              a Matcher, every described resource access attribute must match
              the resource access Context.
            </dd>

            <dt id="acp-agent-matcher">
              <a href="#acp-agent"><code>acp:agent</code></a>
            </dt>
            <dd about="acp:agent" property="rdfs:comment">
              The agent attribute used in a Matcher defines a set of agents, at
              least one of which MUST match the resource access Context for the
              agent restriction to be satisfied.
            </dd>

            <dt
              id="acp-public-agent"
              about="acp:PublicAgent"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="owl:NamedIndividual acp:AlwaysSatisfiedRestriction"
            >
              <code>acp:PublicAgent</code>
            </dt>
            <dd about="acp:PublicAgent" property="rdfs:comment">
              The <span property="rdfs:label">Public Agent</span> named
              individual used in an agent restriction means that the restriction
              is always satisfied.
            </dd>

            <dt
              id="acp-authenticated-agent"
              about="acp:AuthenticatedAgent"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="owl:NamedIndividual"
            >
              <code>acp:AuthenticatedAgent</code>
            </dt>
            <dd about="acp:AuthenticatedAgent" property="rdfs:comment">
              The <span property="rdfs:label">Authenticated Agent</span> named
              individual used in an agent restriction means that any agent in
              the Context satisfies the restriction.
            </dd>

            <dt
              id="acp-creator-agent"
              about="acp:CreatorAgent"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="owl:NamedIndividual"
            >
              <code>acp:CreatorAgent</code>
            </dt>
            <dd about="acp:CreatorAgent" property="rdfs:comment">
              The <span property="rdfs:label">Creator Agent</span> named
              individual used in an agent restriction means that the restriction
              is satisfied if the Context contains an agent that is also a
              creator.
            </dd>

            <dt
              id="acp-owner-agent"
              about="acp:OwnerAgent"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="owl:NamedIndividual"
            >
              <code>acp:OwnerAgent</code>
            </dt>
            <dd about="acp:OwnerAgent" property="rdfs:comment">
              The <span property="rdfs:label">Owner Agent</span> named
              individual used in an agent restriction means that the restriction
              is satisfied if the Context contains an agent that is also an
              owner.
            </dd>

            <dt id="acp-client-matcher">
              <a href="#acp-client"><code>acp:client</code></a>
            </dt>
            <dd about="acp:client" property="rdfs:comment">
              The client attribute used in a Matcher defines a set of clients,
              at least one of which MUST match the resource access Context for
              the client restriction to be satisfied.
            </dd>

            <dt
              id="acp-public-client"
              about="acp:PublicClient"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="owl:NamedIndividual acp:AlwaysSatisfiedRestriction"
            >
              <code>acp:PublicClient</code>
            </dt>
            <dd about="acp:PublicClient" property="rdfs:comment">
              The <span property="rdfs:label">Public Client</span> named
              individual used in a client restriction means that the restriction
              is always satisfied.
            </dd>

            <dt id="acp-issuer-matcher">
              <a href="#acp-issuer"><code>acp:issuer</code></a>
            </dt>
            <dd about="acp:issuer" property="rdfs:comment">
              The issuer attribute used in a Matcher defines a set of issuers,
              at least one of which MUST match the resource access Context for
              the issuer restriction to be satisfied.
            </dd>

            <dt
              id="acp-public-issuer"
              about="acp:PublicIssuer"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="owl:NamedIndividual acp:AlwaysSatisfiedRestriction"
            >
              <code>acp:PublicIssuer</code>
            </dt>
            <dd about="acp:PublicIssuer" property="rdfs:comment">
              The <span property="rdfs:label">Public Issuer</span> named
              individual used in an issuer restriction means that the
              restriction is always satisfied.
            </dd>

            <dt id="acp-time-matcher">
              <a href="#acp-time"><code>acp:time</code></a>
            </dt>
            <dd about="acp:time" property="rdfs:comment">
              The time attribute used in a Matcher defines a set of times, at
              least one of which MUST match the resource access Context for the
              time restriction is satisfied.
            </dd>

            <dt id="acp-vc-matcher">
              <a href="#acp-vc"><code>acp:vc</code></a>
            </dt>
            <dd about="acp:vc" property="rdfs:comment">
              The vc attribute used in a Matcher defines a set of types of
              <a href="https://www.w3.org/TR/vc-data-model/"
                ><dfn id="verifiable-credentials"
                  >Verifiable Credentials</dfn
                ></a
              >
              (VC), at least one of which MUST match the resource access Context
              for the vc restriction to be satisfied.
            </dd>

            <dt
              id="acp-always-satisfied-restriction"
              about="acp:AlwaysSatisfiedRestriction"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdfs:Class"
            >
              <code>acp:AlwaysSatisfiedRestriction</code>
            </dt>
            <dd about="acp:AlwaysSatisfiedRestriction" property="rdfs:comment">
              Defined instances of the
              <span property="rdfs:label">Always Satisfied Restriction</span>
              class are used in Matcher restrictions to indicate that the
              restriction is always satisfied. The default behaviour of a
              Matcher is to not be satisfied, so this is the only way to make a
              Matcher always satisfied.
            </dd>
          </dl>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":example-matcher"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="example-matcher">
              <span class="secno">4.4.1. </span
              ><span class="content">Example Matcher</span
              ><a class="self-link" href="#example-matcher"></a>
            </h4>
            <p>
              The following example authorization graph means that Agent Matcher
              A will be satisfied when either Alice or the owner of the access
              controlled resource are requesting access.
            </p>

            <pre
              id="example-matcher-0"
              class="example example-authorization-graph"
            >
ex:matcherA
  a acp:Matcher ;
  acp:agent ex:Alice, acp:OwnerAgent .&nbsp;&nbsp;
</pre
            >

            <p>
              The following example authorization graph means that the defined
              Client Matcher will be satisfied when matched against a context
              graph where the client used to access the access controlled
              resource is client B.
            </p>

            <pre
              id="example-matcher-1"
              class="example example-authorization-graph"
            >
[
  a acp:Matcher ;
  acp:client ex:clientB ;&nbsp;&nbsp;
] .
</pre
            >

            <p>
              The following example authorization graph means that Issuer
              Matcher A will be satisfied when matched against a context graph
              where the identity provider used to assert the identity of the
              agent requesting access to the access controlled resource is
              issuer B.
            </p>

            <pre
              id="example-matcher-2"
              class="example example-authorization-graph"
            >
ex:matcherA
  a acp:Matcher ;
  acp:issuer ex:issuerB .&nbsp;&nbsp;
</pre
            >

            <p>
              The following example authorization graph means that the defined
              Verifiable Credentials (VC) Matcher A will be satisfied when
              matched against a context graph where one of the presented
              verifiable credentials is an instance of credential B, is valid
              and has been issued to the agent requesting the resource.
            </p>

            <pre
              id="example-matcher-3"
              class="example example-authorization-graph"
            >
[]
  a acp:Matcher ;
  acp:vc ex:credentialB .&nbsp;&nbsp;
</pre
            >

            <p>
              The following example authorization graph means that matcher A
              will be satisfied only if either Alice or Bob are the agent
              requesting resource access and their identity was asserted by
              Identity Provider B.
            </p>

            <pre
              id="example-matcher-4"
              class="example example-authorization-graph"
            >
ex:matcherA
  a acp:Matcher ;
  acp:agent ex:Bob, ex:Alice ;
  acp:issuer ex:IdentityProviderB .&nbsp;&nbsp;
</pre
            >

            <p>
              The following example authorization graph means that the defined
              matcher will be satisfied only if Alice, whose identity is
              asserted by Identity Provider B, is the agent requesting resource
              access and is doing so presenting a VC that is a verified instance
              of credential A issued to Alice.
            </p>

            <pre
              id="example-matcher-5"
              class="example example-authorization-graph"
            >
[
  a acp:Matcher ;
  acp:agent ex:Alice ;
  acp:issuer ex:IdentityProviderB ;&nbsp;&nbsp;
  acp:vc ex:credentialA ;
] .
</pre
            >

            <p>
              The following example authorization graph means that Policy A
              denies Read and Write access to all clients but client C and
              policy B allows read to all clients. If Policy A and B control
              access to a resource, then anyone using client C will have Read
              access to that resource.
            </p>

            <pre
              id="example-matcher-6"
              class="example example-authorization-graph"
            >
ex:policyA
  acp:deny acl:Read, acl:Write ;
  acp:anyOf [
    acp:client acp:PublicClient ;&nbsp;&nbsp;
  ] ,
  acp:noneOf [
    acp:client ex:clientC
  ] .

ex:policyB
  acp:allow acl:Read ;
  acp:anyOf [
    acp:client:PublicClient ;
  ] .
</pre
            >
          </section>
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":matcher-extensibility"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="matcher-extensibility">
            <span class="secno">4.5. </span
            ><span class="content">Matcher extensibility</span
            ><a class="self-link" href="#matcher-extensibility"></a>
          </h3>
          <p about="acp:Matcher" property="rdfs:comment">
            All sub-properties of <code>acp:attribute</code> correspond
            implicitly to their own type of Matcher restriction. If applications
            support additional sub-properties of
            <code>acp:attribute</code> other than the ones defined by ACP, then,
            they MUST also implement corresponding matching algorithms.
          </p>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":example-matcher-extension"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="example-matcher-extension">
              <span class="secno">4.5.1. </span
              ><span class="content">Example Matcher extension</span
              ><a class="self-link" href="#example-matcher-extension"></a>
            </h4>
            <p>
              Given the property <code>ex:tag</code> previously defined in the
              <a href="#example-context-extension">example context extension</a>
              as a an <code>rdfs:subPropertyOf acp:attribute</code> that
              describes tags applied to requested resources; the following
              example context graph would mean that Policy 1 allows Read and is
              satisfied by instances of resource access initiated over a
              resource that was tagged <code>ex:FavouriteRecord</code> or
              <code>ex:Wishlist</code>.
            </p>

            <pre
              id="example-matcher-extension-0"
              class="example example-authorization-graph"
            >
ex:policy1
  acp:allow acl:Read ;
  acp:anyOf [
    ex:tag ex:FavouriteRecord, ex:Wishlist ;&nbsp;&nbsp;
  ] .
</pre
            >
          </section>
        </section>
      </section>

      <section
        datatype="rdf:HTML"
        typeof="bibo:Chapter"
        resource=":access-grant-graph"
        property="bibo:hasPart"
      >
        <h2 class="heading" id="access-grant-graph">
          <span class="secno">5. </span
          ><span class="content">Access Grant Graph</span
          ><a class="self-link" href="#access-grant-graph"></a>
        </h2>
        <p>
          This section introduces the ACP terms used to grant access to
          resources.
        </p>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":access-grant"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="access-grant">
            <span class="secno">5.1. </span
            ><span class="content">Access Grant</span
            ><a class="self-link" href="#access-grant"></a>
          </h3>
          <dl>
            <dt
              id="acp-access-grant"
              about="acp:AccessGrant"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdfs:Class"
            >
              <code>acp:AccessGrant</code>
            </dt>
            <dd about="acp:AccessGrant" property="rdfs:comment">
              Instances of the
              <span property="rdfs:label">Access Grant</span> class define sets
              of Access Modes granted in particular Contexts.
            </dd>

            <dt
              id="acp-context"
              about="acp:context"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:context</code>
            </dt>
            <dd about="acp:context" property="rdfs:comment">
              The <span property="rdfs:label">context</span> property connects
              <span property="rdfs:domain" resource="acp:AccessGrant"
                >Access Grants</span
              >
              to the
              <span property="rdfs:range" resource="acp:Context">Contexts</span>
              in which they're given.
            </dd>

            <dt
              id="acp-grant"
              about="acp:grant"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdf:Property"
            >
              <code>acp:grant</code>
            </dt>
            <dd about="acp:grant" property="rdfs:comment">
              The <span property="rdfs:label">grant</span> property connects
              <span property="rdfs:domain" resource="acp:AccessGrant"
                >Access Grants</span
              >
              to the
              <span property="rdfs:range" resource="acp:AccessMode"
                >Access Modes</span
              >
              they grant.
            </dd>
          </dl>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":example-access-grant"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="example-access-grant">
              <span class="secno">5.1.1. </span
              ><span class="content">Example Access Grant</span
              ><a class="self-link" href="#example-access-grant"></a>
            </h4>
            <p>
              The following example access grant graph means that Access Modes
              <code>acl:Read</code> and <code>acl:Write</code> have been granted
              to Bob for accessing resource X.
            </p>

            <pre
              id="example-access-grant-0"
              class="example example-access-grant-graph"
            >
[]
  acp:grant acl:Read, acl:Write ;&nbsp;&nbsp;
  acp:context [
    acp:agent ex:Bob ;
    acp:target ex:resourceX ;
  ] .
</pre
            >
          </section>
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":access-mode-extensibility"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="access-mode-extensibility">
            <span class="secno">5.2. </span
            ><span class="content">Access Mode extensibility</span
            ><a class="self-link" href="#access-mode-extensibility"></a>
          </h3>
          <dl>
            <dt
              id="acp-access-mode"
              about="acp:AccessMode"
              property="rdfs:isDefinedBy"
              resource="acp:"
              typeof="rdfs:Class"
            >
              <code>acp:AccessMode</code>
            </dt>
            <dd about="acp:AccessMode" property="rdfs:comment">
              The ACP specification does not define specific Access Modes.
              Instead, any Access Mode granted is an instance of the
              <span property="rdfs:label">Access Mode</span> class. Access Modes
              and their granularity can be tailored to the needs of an
              application. Access Modes defined in other vocabularies (<span
                property="rdfs:seeAlso"
                >for example ACL</span
              >) can also be used.
            </dd>
          </dl>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":example-access-mode"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="example-access-mode">
              <span class="secno">5.2.1. </span
              ><span class="content">Example Access Mode</span
              ><a class="self-link" href="#example-access-mode"></a>
            </h4>
            <p>
              The following example access grant graph means that
              <code>acl:Read</code> and <code>ex:Delete</code> are Access Modes;
              furthermore, it means that <code>acl:Read</code> and
              <code>ex:Delete</code> have been granted to Bob for accessing
              resource X.
            </p>

            <pre
              id="example-access-mode-0"
              class="example example-access-grant-graph"
            >
[]
  acp:grant acl:Read, ex:Delete ;&nbsp;&nbsp;
  acp:context [
    acp:agent ex:Bob ;
    acp:target ex:resourceX ;
  ] .
</pre
            >
          </section>
        </section>
      </section>

      <section
        datatype="rdf:HTML"
        typeof="bibo:Chapter"
        resource=":access-control-resolution"
        property="bibo:hasPart"
      >
        <h2 class="heading" id="access-control-resolution">
          <span class="secno">6. </span
          ><span class="content">Access Control resolution</span
          ><a class="self-link" href="#access-control-resolution"></a>
        </h2>
        <p>
          This section introduces the ACP access control resolution algorithm
          for resolving permissions to access controlled resources.
        </p>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":effective-policies"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="effective-policies">
            <span class="secno">6.1. </span
            ><span class="content">Effective Policies</span
            ><a class="self-link" href="#effective-policies"></a>
          </h3>
          <p>
            Both the <code>acp:resource</code> property and its inverse
            <code>acp:accessControlResource</code> MUST be taken into account in
            determining the Access Control Resources controlling access to
            resources.
          </p>

          <p>
            All Access Controls controlling member resources access via the
            <code>acp:memberAccessControl</code> property MUST be included in
            the set of Access Controls linked as
            <code>acp:accessControl</code> in the effective authorization graph
            of a resource.
          </p>

          <p>
            The set of Policies controlling access to a resource MUST contain
            all Policies that are linked to a resource via the
            <a href="https://www.w3.org/TR/sparql11-query/#propertypaths"
              ><dfn id="sparql-property-path">property path</dfn></a
            >
            <code>acp:accessControlResource/acp:accessControl/acp:apply</code>
            <cite
              ><a class="bibref" href="#sparql11-query">SPARQL11 QUERY</a></cite
            >.
          </p>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":effective-policies-example"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="effective-policies-example">
              <span class="secno">6.1.1. </span
              ><span class="content">Effective Policies example</span
              ><a class="self-link" href="#effective-policies-example"></a>
            </h4>
            <p>
              The following example authorization graph means that access to
              resource X is controlled by both Access Controls B and C, access
              to resource X is therefore controlled by Policy E and Policy F.
              The member Access Controls are not taken into account at this
              level. Member Access Control D will be included in the effective
              authorization graph of resource X's members' ACRs both as an
              Access Control and a member Access Control. Therefore, Policy G
              will be part of the set of effective Policies controlling access
              to resource X's members and transitively to further members of
              member resources.
            </p>

            <pre
              id="determining-effective-policies-example-0"
              class="example example-authorization-graph"
            >
  ex:accessControlResourceA
    acp:resource ex:X ;
    acp:accessControl ex:accessControlB, ex:accessControlC ;&nbsp;&nbsp;
    acp:memberAccessControl ex:accessControlD .

  ex:accessControlB
    acp:apply ex:PolicyE .

  ex:accessControlC
    acp:apply ex:PolicyF .

  ex:accessControlD
    acp:apply ex:PolicyG .
</pre
            >
          </section>
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":granted-access-modes"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="granted-access-modes">
            <span class="secno">6.2. </span
            ><span class="content">Granted Access Modes</span
            ><a class="self-link" href="#granted-access-modes"></a>
          </h3>
          <div about="acp:Policy" property="rdfs:comment">
            <p>
              An Access Mode MUST be granted over a resource if and only if in
              the set of Policies controlling access to it:
            </p>
            <ul>
              <li>A satisfied policy allows the Access Mode; and</li>
              <li>No satisfied policy denies the Access Mode.</li>
            </ul>
          </div>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":granted-access-modes-example"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="granted-access-modes-example">
              <span class="secno">6.2.1. </span
              ><span class="content">Granted Access Modes example</span
              ><a class="self-link" href="#granted-access-modes-example"></a>
            </h4>
            <p>
              The following example authorization graph means that access to
              resource X is controlled by Policy B and Policy C. Depending on
              the satisfaction of Policies B and C, different access modes will
              be granted.
            </p>
            <ul>
              <li>
                If only Policy B is satisfied, then Access Modes
                <code>acl:Read</code> and <code>acl:Write</code> will be
                granted.
              </li>
              <li>
                If both Policy B and Policy C are satisfied, then only Access
                Mode <code>acl:Read</code> will be granted.
              </li>
              <li>
                If only Policy C is satisfied, then no Access Mode will be
                granted.
              </li>
            </ul>

            <pre
              id="granting-access-example-0"
              class="example example-authorization-graph"
            >
[
  acp:resource ex:X ;
  acp:accessControl [
    acp:apply ex:policyB, ex:policyC ;&nbsp;&nbsp;
  ]
] .

ex:policyB
  acp:allow acl:Read, acl:Write .

ex:policyC
  acp:deny acl:Write .
</pre
            >
          </section>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":granted-access-modes-pseudocode"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="granted-access-modes-pseudocode">
              <span class="secno">6.2.2. </span
              ><span class="content">Granted Access Modes pseudocode</span
              ><a class="self-link" href="#granted-access-modes-pseudocode"></a>
            </h4>
            <pre
              class="highlight pseudocode"
            ><code><span class="kd">function</span> <span class="nx">grantAccessModes</span><span class="p">(</span><span class="nx">policies</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">allow</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">,</span> <span class="nx">deny</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Set</span>

  <span class="c1">// Gather allowed and denied access modes from satisfied policies</span>&nbsp;&nbsp;
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">policy</span> <span class="k">of</span> <span class="nx">policies</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">isSatisfiedPolicy</span><span class="p">(</span><span class="nx">policy</span><span class="p">,</span> <span class="nx">context</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">mode</span> <span class="k">of</span> <span class="nx">policy</span><span class="p">.</span><span class="nx">allow</span><span class="p">)</span>
              <span class="nx">allow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">mode</span><span class="p">)</span>

          <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">mode</span> <span class="k">of</span> <span class="nx">policy</span><span class="p">.</span><span class="nx">deny</span><span class="p">)</span>
              <span class="nx">deny</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">mode</span><span class="p">)</span>
      <span class="p">}</span>

  <span class="c1">// Deny overrules allow.</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">mode</span> <span class="k">of</span> <span class="nx">deny</span><span class="p">)</span>
      <span class="nx">allow</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">mode</span><span class="p">)</span>

  <span class="k">return</span> <span class="nx">allow</span>
<span class="p">}</span>
</code></pre>
          </section>
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":satisfied-policy"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="satisfied-policy">
            <span class="secno">6.3. </span
            ><span class="content">Satisfied Policy</span
            ><a class="self-link" href="#satisfied-policy"></a>
          </h3>
          <p>
            Policies are satisfied via the <code>acp:allOf</code>,
            <code>acp:anyOf</code> and <code>acp:noneOf</code> properties which
            act respectively as intersection, union and exclusion operators.
          </p>

          <div about="acp:Policy" property="rdfs:comment">
            <p>A Policy MUST be considered satisfied if and only if:</p>
            <ul>
              <li>
                It references at least one Matcher via a
                <code>acp:allOf</code> or <code>acp:anyOf</code> property; and
              </li>
              <li>
                At least one Matcher it references matches the given resource
                access description; and
              </li>
              <li>
                The <code>acp:allOf</code>, <code>acp:anyOf</code> and
                <code>acp:noneOf</code> of conditions it defines are satisfied.
              </li>
            </ul>
          </div>

          <p>
            Given that the <code>acp:noneOf</code> condition excludes matches, a
            policy without a satisfied <code>acp:allOf</code> or
            <code>acp:anyOf</code> condition is never satisfied.
          </p>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":satisfied-policy-example"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="satisfied-policy-example">
              <span class="secno">6.3.1. </span
              ><span class="content">Satisfied Policy example</span
              ><a class="self-link" href="#satisfied-policy-example"></a>
            </h4>
            <p>
              The following example authorization graph means that access to
              resource X is controlled by Policy A. Depending on the
              satisfaction of Matchers B, C, D, E and F, Policy A will be
              satisfied or not.
            </p>
            <ul>
              <li>
                If either Matcher B or Matcher C are not satisfied, then Policy
                A will not be satisfied.
              </li>
              <li>
                If both Matcher D and Matcher E are not satisfied, then Policy A
                will not be satisfied.
              </li>
              <li>
                If Matcher F is satisfied, then Policy A will not be satisfied.
              </li>
              <li>
                If both Matcher B and Matcher C are satisfied, and, either
                Matcher D or Matcher E are satisfied, and, Matcher F is not
                satisfied, then Policy A will be satisfied.
              </li>
            </ul>

            <pre
              id="satisfying-policy-example-0"
              class="example example-authorization-graph"
            >
[
  acp:resource ex:X ;
  acp:accessControl [
    acp:apply ex:policyA ;
  ]
] .

ex:policyA
  acp:allOf ex:matcherB, ex:matcherC ;&nbsp;&nbsp;
  acp:anyOf ex:matcherD, matcherE ;
  acp:noneOf ex:matcherF .
</pre
            >
          </section>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":satisfied-policy-pseudocode"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="satisfied-policy-pseudocode">
              <span class="secno">6.3.2. </span
              ><span class="content">Satisfied Policy pseudocode</span
              ><a class="self-link" href="#satisfied-policy-pseudocode"></a>
            </h4>
            <pre
              class="highlight pseudocode"
            ><code><span class="kd">function</span> <span class="nx">isSatisfiedPolicy</span><span class="p">(</span><span class="nx">policy</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// If any 'none of' matcher is satisfied then the policy is not satisfied.</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">matcher</span> <span class="k">of</span> <span class="nx">policy</span><span class="p">.</span><span class="nx">noneOf</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">isSatisfiedMatcher</span><span class="p">(</span><span class="nx">matcher</span><span class="p">,</span> <span class="nx">context</span><span class="p">))</span>
          <span class="k">return</span> <span class="kc">false</span>

  <span class="c1">// If any 'all of' matcher is not satisfied then the policy is not satisfied.</span>&nbsp;&nbsp;
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">matcher</span> <span class="k">of</span> <span class="nx">policy</span><span class="p">.</span><span class="nx">allOf</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isSatisfiedMatcher</span><span class="p">(</span><span class="nx">matcher</span><span class="p">,</span> <span class="nx">context</span><span class="p">))</span>
          <span class="k">return</span> <span class="kc">false</span>

  <span class="c1">// If any 'any of' matcher is satisfied then the policy is satisfied.</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">matcher</span> <span class="k">of</span> <span class="nx">policy</span><span class="p">.</span><span class="nx">anyOf</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">isSatisfiedMatcher</span><span class="p">(</span><span class="nx">matcher</span><span class="p">,</span> <span class="nx">context</span><span class="p">))</span>
          <span class="k">return</span> <span class="kc">true</span>

  <span class="c1">// At this point there are</span>
  <span class="c1">// - no satisfied 'none of' matchers,</span>
  <span class="c1">// - no unsatisfied 'all of' matchers and</span>
  <span class="c1">// - no satisfied 'any of' matchers.</span>

  <span class="c1">// Hence, the policy is satisfied if it has</span>
  <span class="c1">// - an 'all of' condition and</span>
  <span class="c1">// - no 'any of' condition.</span>
  <span class="k">return</span> <span class="nx">policy</span><span class="p">.</span><span class="nx">allOf</span><span class="p">.</span><span class="nx">size</span> <span class="o">!==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">policy</span><span class="p">.</span><span class="nx">anyOf</span><span class="p">.</span><span class="nx">size</span> <span class="o">===</span> <span class="mi">0</span>
<span class="p">}</span>
</code></pre>
          </section>
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":satisfied-matcher"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="satisfied-matcher">
            <span class="secno">6.4. </span
            ><span class="content">Satisfied Matcher</span
            ><a class="self-link" href="#satisfied-matcher"></a>
          </h3>
          <p>
            The default operation of matching is based on
            <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri-equality"
              ><dfn>IRI</dfn></a
            >
            and
            <a
              href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal-term-equality"
              ><dfn>literal term equality</dfn></a
            >
            as defined in the RDF 1.1 Concepts and Abstract Syntax
            <cite
              ><a class="bibref" href="#rdf11-concepts">RDF11 CONCEPTS</a></cite
            >.
          </p>

          <div about="acp:Matcher" property="rdfs:comment">
            <p>A Matcher MUST be considered satisfied if and only if:</p>
            <ul>
              <li>It defines at least one matching attribute; and</li>
              <li>
                All the attributes defined find a match in the given resource
                access description.
              </li>
            </ul>
          </div>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":satisfied-matcher-example"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="satisfied-matcher-example">
              <span class="secno">6.4.1. </span
              ><span class="content">Satisfied Matcher example</span
              ><a class="self-link" href="#satisfied-matcher-example"></a>
            </h4>
          </section>

          <section
            datatype="rdf:HTML"
            typeof="bibo:Chapter"
            resource=":satisfied-matcher-pseudocode"
            property="bibo:hasPart"
          >
            <h4 class="heading" id="satisfied-matcher-pseudocode">
              <span class="secno">6.4.2. </span
              ><span class="content">Satisfied Matcher pseudocode</span
              ><a class="self-link" href="#satisfied-matcher-pseudocode"></a>
            </h4>
          </section>
        </section>
      </section>

      <section
        datatype="rdf:HTML"
        typeof="bibo:Chapter"
        resource=":server-implementation"
        property="bibo:hasPart"
      >
        <h2 class="heading" id="server-implementation">
          <span class="secno">7. </span
          ><span class="content">Server implementation</span
          ><a class="self-link" href="#server-implementation"></a>
        </h2>
        <p>
          This section introduces ACP server capability and ACR discovery, as
          well as ACR editing, and ACP resources lifecycle management.
        </p>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":capability-discovery"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="capability-discovery">
            <span class="secno">7.1. </span
            ><span class="content">Capability discovery</span
            ><a class="self-link" href="#capability-discovery"></a>
          </h3>
          <p>
            When a server wants to enable applications to discover its ACP
            capabilities, it MUST do so via link headers.
          </p>

          <p>
            The server MUST advertise the access modes it supports by responding
            to HTTP OPTIONS requests over ACP access control resources including
            a Link header with the rel value of
            <code>http://www.w3.org/ns/solid/acp#grant</code> and the full URI
            of an access mode as link target [RFC8288]. The server MUST produce
            one such Link header for each access mode it supports.
          </p>

          <p>
            For example, if a server supports the ACL read, write and append
            access modes, it should advertise it by responding to HTTP OPTIONS
            requests over ACP access control resources including three link
            headers with rel value of
            <code>http://www.w3.org/ns/solid/acp#grant</code> and respectively
            targets of <code>http://www.w3.org/ns/auth/acl#Read</code>,
            <code>http://www.w3.org/ns/auth/acl#Write</code> and
            <code>http://www.w3.org/ns/auth/acl#Append</code> in order to make
            it explicit which set of access modes are understood and relevant
            when editing ACP policies.
          </p>

          <p>
            The server MUST advertise the request attributes it supports by
            responding to HTTP OPTIONS requests over ACP access control
            resources including a Link header with the rel value of
            <code>http://www.w3.org/ns/solid/acp#attribute</code> and the full
            URI of an acp attribute as link target [RFC8288]. The server MUST
            produce one such Link header for each request attribute it supports.
          </p>

          <p>
            For example, if a server supports the ACP agent, client and issuer
            request attributes, it should advertise it by responding to HTTP
            OPTIONS requests over ACP access control resources including three
            link headers with rel value of
            <code>http://www.w3.org/ns/solid/acp#attribute</code> and
            respectively targets of
            <code>http://www.w3.org/ns/solid/acp#agent</code>,
            <code>http://www.w3.org/ns/solid/acp#client</code> and
            <code>http://www.w3.org/ns/solid/acp#issuer</code> in order to make
            it explicit which set of request attributes are understood and
            relevant when editing ACP matchers.
          </p>
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":acr-discovery"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="acr-discovery">
            <span class="secno">7.2. </span
            ><span class="content">ACR discovery</span
            ><a class="self-link" href="#acr-discovery"></a>
          </h3>
          <p>
            When a server wants to enable applications to discover the ACP
            access control resource associated with a given resource, the server
            MUST advertise the ACP access control resource that is associated
            with that resource by responding to HTTP requests over the resource
            including a <code>Link</code> header with the <code>rel</code> value
            of <code>acl</code> (acl Link Relation) and the ACP access control
            resource as the link target [RFC8288]. The same mechanism is used in
            <a
              href="https://solid.github.io/web-access-control-spec/#acl-resource-discovery"
              >Web Access Control resource discovery</a
            >.
          </p>
          <p>
            A server responding to an HTTP request over an ACP access control
            resource MUST include a <code>Link</code> header with the
            <code>rel</code> value of <code>type</code> and the
            <code>acp:AccessControlResource</code> URI as link target.
          </p>
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":acr-editing"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="acr-editing">
            <span class="secno">7.3. </span
            ><span class="content">ACR editing</span
            ><a class="self-link" href="#acr-editing"></a>
          </h3>
          <p>
            The owner of a storage is implicitly considered an owner of all the
            resources in the URI space corresponding to the storage.
          </p>

          <p>
            An owner of a resource is implicitly considered an owner of its
            associated Access Control Resource.
          </p>

          <p>
            An owner of an Access Control Resource implicitly has full read and
            write access over it.
          </p>

          <p>
            To add or remove an Access Control from an ACR, agents that are not
            owners of said ACR need read and write access to both the ACR itself
            and to the resource where said Access Control is defined. In other
            words, Access Controls defined as part of a separate resource can be
            protected from unwanted edits in and out of ACRs by setting adequate
            permissions in their own ACR.
          </p>
        </section>

        <section
          datatype="rdf:HTML"
          typeof="bibo:Chapter"
          resource=":resource-management"
          property="bibo:hasPart"
        >
          <h3 class="heading" id="resource-management">
            <span class="secno">7.4. </span
            ><span class="content">Resource management</span
            ><a class="self-link" href="#resource-management"></a>
          </h3>
          <p>Access Control Resources MUST be server managed.</p>

          <p>
            There is a one to one relationship between a resource and its
            authoritative source of access control. Therefore, when resources
            are created or deleted, the corresponding ACRs MUST be created or
            deleted accordingly.
          </p>

          <p>
            Access Controls, Policies and Matchers MAY all be access controlled
            via their own ACR.
          </p>

          <p>
            As long as an Access Control, a Policy or a Matcher is referenced by
            an ACR, it MUST not be deleted. However, if such consistency failed
            to be enforced or if an Access Control, a Policy or a Matcher is not
            accessible for any other reason, then access permissions resolution
            MUST fail to its default behaviour of only granting read and write
            access to the invalid ACR to its owners; read and write access MUST
            not be implicitly granted to a resource whose access control
            resolution fails, even to owners of that resource.
          </p>
        </section>
      </section>
    </main>

    <section
      datatype="rdf:HTML"
      typeof="bibo:Chapter"
      resource=":acknowledgements"
      property="bibo:hasPart"
    >
      <h2 id="acknowledgements">Acknowledgements</h2>
      <p><em>This section is non-normative.</em></p>
    </section>

    <section
      datatype="rdf:HTML"
      typeof="bibo:Chapter"
      resource=":references"
      property="bibo:hasPart"
    >
      <h2 id="references">References</h2>

      <section
        datatype="rdf:HTML"
        typeof="bibo:Chapter"
        resource=":normative-references"
        property="bibo:hasPart"
      >
        <h3 id="normative-references">Normative references</h3>
        <dl resource="">
          <dt id="rdf11-concepts">[RDF11-CONCEPTS]</dt>
          <dd>
            <a
              href="https://www.w3.org/TR/rdf11-concepts/"
              rel="cito:citesAsAuthority"
              ><cite>RDF 1.1 Concepts and Abstract Syntax</cite></a
            >. Richard Cyganiak; David Wood; Markus Lanthaler. W3C. 25 February
            2014. W3C Recommendation. URL:
            <a href="https://www.w3.org/TR/rdf11-concepts/"
              >https://www.w3.org/TR/rdf11-concepts/</a
            >.
          </dd>
          <dt id="rfc2119">[RFC2119]</dt>
          <dd>
            <a
              href="https://www.rfc-editor.org/info/rfc2119"
              rel="cito:citesAsAuthority"
              ><cite
                >Key words for use in RFCs to Indicate Requirement Levels</cite
              ></a
            >. S. Bradner. IETF. March 1997. Best Current Practice. URL:
            <a href="https://datatracker.ietf.org/doc/html/rfc2119"
              >https://datatracker.ietf.org/doc/html/rfc2119</a
            >.
          </dd>
          <dt id="rfc8174">[RFC8174]</dt>
          <dd>
            <a
              href="https://www.rfc-editor.org/info/rfc8174"
              rel="cito:citesAsAuthority"
              ><cite
                >Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite
              ></a
            >. B. Leiba. IETF. May 2017. Best Current Practice. URL:
            <a href="https://datatracker.ietf.org/doc/html/rfc8174"
              >https://datatracker.ietf.org/doc/html/rfc8174</a
            >.
          </dd>
          <dt id="sparql11-query">[SPARQL11-QUERY]</dt>
          <dd>
            <a
              href="https://www.w3.org/TR/sparql11-query/"
              rel="cito:citesAsAuthority"
              ><cite>SPARQL 1.1 Query</cite></a
            >. Steve Harris; Andy Seaborne; Eric Prud'hommeaux. W3C. 21 March
            2013. W3C Recommendation. URL:
            <a href="https://www.w3.org/TR/sparql11-query/"
              >https://www.w3.org/TR/sparql11-query/</a
            >.
          </dd>
        </dl>
      </section>

      <section
        datatype="rdf:HTML"
        typeof="bibo:Chapter"
        resource=":informative-references"
        property="bibo:hasPart"
      >
        <h3 id="informative-references">Informative references</h3>
      </section>
    </section>

    <p role="navigation" id="back-to-top">
      <a href="#table-of-contents"><abbr title="Back to top">â</abbr></a>
    </p>

    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  </body>
</html>
